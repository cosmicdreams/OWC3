<?php
/**
 * @file
 * Module file for block_example.
 */

/**
 * Implements hook_block_view().
 *
 * This hook generates the contents of the blocks themselves.
 */
function jj_custom_blocks_block_goroo_trip_planner_block_view() {
  if (arg(0) == 'node' && is_numeric(arg(1))) {
  	$nid = arg(1); 
  	$thisnode = node_load($nid);  //dpm($thisnode);
  	$default_address = '';
  	$nearest_stop = 'Address, Intersection or Station';
  	if (!empty($thisnode->field_business_address)) {
  		$street = $thisnode->field_business_address['und'][0]['thoroughfare'];
  		$city = $thisnode->field_business_address['und'][0]['locality'];
  		$state = $thisnode->field_business_address['und'][0]['administrative_area'];
  		$default_address = $street.', '.$city.', '.$state;
  	}
  	if (!empty($thisnode->field_business_nearest_stop)) {
  		$nearest_stop = $thisnode->field_business_nearest_stop['und'][0]['value'];
  	}
  }

  $block = array();
  // The subject is displayed at the top of the block. Note that it
  // should be passed through t() for translation. The title configured
  // for the block using Drupal UI supercedes this one.
  $block['subject'] = t('Trip Planner');
  // The content of the block is typically generated by calling a custom
  // function.
  drupal_add_css(drupal_get_path('module', 'jj_custom_blocks') . '/css/goroo.css');
  $imagePath = drupal_get_path('module', 'jj_custom_blocks') . '/images';
  $block['content'] = '
<div id="tripplannerhs" class="hide">
<div id="tpmenu" class="clr">
<div class="tponleft">
	<img src="' . $imagePath . '/onsepleft.gif" border="0" />
</div>
<div class="topmenu"><a href="#tripplanner">Trip Planner</a></div>

<div class="tponright">
	<img src="' . $imagePath . '/onsepright.gif" border="0" />
</div>



</div>
<form name="tripPlan" id="tripPlan" method="post" action="http://goroo.com/goroo/showTripPlanResults.htm" target="_blank" title="Plan Your Trip">
<div class="tppad">



	<div class="tpbox" style="border-top: 1px solid #b9b9b9;" >
	<input type="hidden" name="actn"  id="actn" value="entry"/>
			<input type="hidden" value="false" id="advanced" name="advanced"/>
		<input type="hidden" value="true" id="newTrip" name="newTrip"/>
		<input type="hidden" value="true" id="newRequest" name="newRequest"/>

		<input type="hidden" id="origData" name="origData" />
		<input type="hidden" id="destData" name="destData" />
		<input type="hidden" value="1" id="trip" name="trip"/>

		<div class="tpboxtitle"><a name="tripplanner">FROM:</a>
		</div>
			<div class="tpboxinput">
				<input size="48" id="origAddress" name="origAddress" title="Origin Address (123 N Main St, Clark and Lake or Lisle Metra)" type="text" value="'.$nearest_stop.'"  onblur="if(this.value==\'\') this.value=\'Address, Intersection or Station\';" onfocus="if(this.value==\'Address, Intersection or Station\') this.value=\'\';" />
			</div>
		<br clear="all"/>

			<div class="tpboxtitle">&nbsp;</div>

			<div class="tpboxinputcaption">
				<font style="color: #666666; font-style: italic;">e.g. 123 N Main, Clark & Lake or Lisle Metra
			</font></div>
	<br clear="all"/>
		<div class="tpboxtitle">TO:
		</div>
			<div class="tpboxinput">
				<input size="48" name="destAddress" id="destAddress" title="Destination Address (123 N Main St, Clark and Lake or Lisle Metra)" type="text" value="'.$default_address.'"  onblur="if(this.value==\'\') this.value=\'Address, Intersection or Station\';" onfocus="if(this.value==\'Address, Intersection or Station\') this.value=\'\';"/>

			</div>
		<br clear="all"/>
			<div class="tpboxtitle">&nbsp;</div><div class="tpboxinputcaption">
			<font style="color: #666666; font-style: italic;">e.g. 123 N Main, Clark & Lake or Lisle Metra</font>
			</div>
	<br />

	</div>

  <div class="tpbox2">
	<div class="tpboxtitle">DATE/TIME:</div><div style="clear:both;"></div>
	<div class="tpboxinput"><div class="tpboxiwantto">I want to</div></div>
	<div class="tpboxinputdatetime2">
			<input type="Radio" id="arriveLeaveYes" name="arriveLeave" checked value="dep" title="leave">leave</input>
			<input type="Radio" id="arriveLeaveNo" name="arriveLeave" value="arr" title="arrive">arrive</input>
	</div>
	<div style="clear:both;"></div>
	<div class="tpboxinputdatetime">
		<input type="hidden" name="f" id="f" value="2012-11-18">
		<input type="hidden" name="f_dp" id="f_dp" value="1">
		<input type="hidden" name="f_year_start" id="f_year_start" value="2012">
		<input type="hidden" name="f_year_end" id="f_year_end" value="2013">
		<select name="f_month" id="f_month" onChange="javascript:tc_setMonth(\'f\', this[this.selectedIndex].value, \'mod_goroo/\');" class="tcmonth" title="Month">
			<option value="">Month</option><option  value = "01">January</option><option  value = "02">February</option><option  value = "03">March</option><option  value = "04">April</option><option  value = "05">May</option><option  value = "06">June</option><option  value = "07">July</option><option  value = "08">August</option><option  value = "09">September</option><option  value = "10">October</option><option selected value = "11">November</option><option  value = "12">December</option></select>				
		<select name="f_day" id="f_day" onChange="javascript:tc_setDay(\'f\', this[this.selectedIndex].value, \'mod_goroo/\');" class="tcday" title="Day">
			<option value="">Day</option><option  value = "01">1</option><option  value = "02">2</option><option  value = "03">3</option><option  value = "04">4</option><option  value = "05">5</option><option  value = "06">6</option><option  value = "07">7</option><option  value = "08">8</option><option  value = "09">9</option><option  value = "10">10</option><option  value = "11">11</option><option  value = "12">12</option><option  value = "13">13</option><option  value = "14">14</option><option  value = "15">15</option><option  value = "16">16</option><option  value = "17">17</option><option selected value = "18">18</option><option  value = "19">19</option><option  value = "20">20</option><option  value = "21">21</option><option  value = "22">22</option><option  value = "23">23</option><option  value = "24">24</option><option  value = "25">25</option><option  value = "26">26</option><option  value = "27">27</option><option  value = "28">28</option><option  value = "29">29</option><option  value = "30">30</option><option  value = "31">31</option></select>
		<select name="f_year" id="f_year" onChange="javascript:tc_setYear(\'f\', this[this.selectedIndex].value, \'mod_goroo/\');" class="tcyear" title="Year">
			<option value="">Year</option><option value="2012" selected>2012</option><option value="2013">2013</option></select>

		<a href="javascript:displayDatePicker(\'f\', \'f_month\', \'ymd\', \'-\');"><img src="' . $imagePath . '/iconCalendar.gif" border="0" align="absmiddle" alt="visual Calendar, screen readers may use the proceeding combo boxes to set the date" /></a>
	</div>
	<br clear="all" />
	<div class="tpboxtitle">&nbsp;</div>

	<div class="tpboxinput">
		<select name="hour" id="hour" title="hours">
			<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4" selected="selected">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option>					</select>:
		<select name="minute" id="minute" title="Minutes">
			<option value="0" selected="selected">00</option><option value="5">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option>					</select>
		<select name="ampm" id="ampm" title="AM or PM">
			<option value=\'AM\' >AM</option><option value=\'PM\'  selected="selected">PM</option></select>
	</div>
   </div>


		<div class="tpbox">

			<div class="tpboxtitle">MODE:</div><div style="clear:both;"></div>
			<div class="tpboxinputdatetime">How do you want to get there?
			</div>
				<div class="tpboxtitle">&nbsp;</div>
			<div class="tpboxinput">
				<input type="checkbox" checked alt="Train" id="train" name="train" title="Travel by train check all that apply" value="true"/>Train</input>
				<input type="checkbox" checked alt="Bus" id="bus" name="bus" title="Travel by bus check all that apply" value="true"/>Bus</input>
				<input type="hidden" checked="unchecked" onClick="loadPage()" alt="Driving" id="drive" name="drive" value="false"/></input>

				<input type="hidden" checked="unchecked" onClick="loadPage()" alt="Drive to Transit" id="driveToTransit" name="driveToTransit" value="false"/></input>
				<input type="checkbox" checked alt="Bicycling" value="true" name="bicycleOptionsRequired" id="bicycleOptionsRequired" onclick="loadPage()">Bicycling</input>
				<input type="checkbox" checked alt="Walking" value="true" name="walkingOptionsRequired" id="walkingOptionsRequired" onclick="loadPage()">Walking</input>
				<input type="hidden" name="travelDate" id="travelDate">
				<input type="hidden" name="mode" id="mode">
			</div>
		</div>



		<div class="tpbox2">
			<input type="submit" value="Submit">
			<div class="tpboxtitle">&nbsp;</div><div class="tpboxinput"><p align="center">
				<a href="javascript:pageTracker._trackEvent(\'Goroo\', \'Get Directions\', \'/pages/bridge_builder_detail/28.php?id=34&page=\'); addTravelDate();"><img src="' . $imagePath . '/Goroo.jpg" style="vertical-align: middle;" border="0" alt="Submit:  goroo trip planner"></a>
</p>
</form>

		

		</div>
		</div>
		</div></div><div style="clear:both;"></div>';
  return $block;
}
